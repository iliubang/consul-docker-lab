# Copyright (c) 2024 The Authors. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Authors: liubang (it.liubang@gmail.com)

# 自动启用基于平台的特定配置
common --enable_platform_specific_config

# common --registry=https://liubang.github.io/playground/registry
common --registry=file://%workspace%/registry
common --registry=https://raw.githubusercontent.com/bazelboost/registry/main
common --registry=https://bcr.bazel.build

common --color=yes
common --experimental_ui_max_stdouterr_bytes=1073741819

build --jobs=10
build --cxxopt=-std=c++17
build --host_cxxopt=-std=c++17

# for llvm
build:llvm --action_env=CC=clang
build:llvm --linkopt=-fuse-ld=lld

# default linux
build:linux --linkopt=-fuse-ld=gold

# default macos
build:macos --action_env=CC=/opt/homebrew/opt/llvm@17/bin/clang

# for java
build --nojava_header_compilation
build --java_runtime_version=21
build --java_language_version=21
build --tool_java_language_version=21
build --tool_java_runtime_version=21

test --test_output=all --action_env="GTEST_COLOR=1" --action_env="GTEST_BREAK_ON_FAILURE=1"
test --nocache_test_results
test --nojava_header_compilation 
